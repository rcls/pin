import sys
sys.set_int_max_str_digits(100000)

str4096='''5221944407065762533458763553583121912899821245236918901921167416
4197695398577872842441340596749877917044505335721963141899378671
9092896803631618043925682638972978488271854999170180795067191859
1572140350059279731131881594196988563728361673421722933087484039
5435290185203564202437005930455723398889179901450334346948844089
3892973452815095130470299789726716411734651513348221529512507986
1999338571077708469177799426457431591189572172483670439059363197
4823755009452067450420853083754683416692527551648604413477538499
1808184705966507606898412918594045916828375610659246423184062775
1129991502061723924312978372460973085737762611265126417421387949
3971578431345661160413703832048403225054273536607170366499297826
2533362967769893638753140153271212198760743202934070528562400428
6213089656011207316539374643385967467433464091624867739564888519
0320044977797683044646412813998470381039259729749462310598069986
1561571609107714460421382722195885390710823888647154297193950535
7852977824374510725537011068943750334195272943099633738106610641
9020778664755901257198919002438521324547808656117570642736748124
7872548339795397394463450081011751817074786926119803092791238421
4767951050921349607430374955877072960724800491954769895954972265
44409857610761851'''
prime4096 = int(str4096.replace('\n', ''))

str8192='''5453740678097079647314921223668914312241320809981163462159163930
9486066592455964760813211726260099361197864589807851263655493541
0088592031805489882538777399539453149421096494769304912614024102
5798484258067958190983859432713046622800606452769509431505089501
2626789995860000503980001326791840045264890294047617525081509773
7826955502656182280007423713017646775622921964459376384348139672
0440278087578471749727033389125704074503080529601282192522890066
6324678291802362120369122140612256575887875958244961318287186121
6138684037513813941522603250896380850472849584248628939841925868
5249984504805602578275250577806357457462576710528744833147735163
9316075286541421511083248516219806931762581320475808400271381171
7998154460845723090593703197655332702442869717416438714083703747
6854967559343781799851950585109118083747293104849285031318060413
5335770407853328756864051351115546378245513837958026043915231620
5524682284377460483661491229592381713691895136224219009263488882
4705363578057902173454137296699959807071213707052995587130302782
4188187815726380568132931419168431057899681901043926883777266839
4957847117216977833157535043606767735127835156002065362747917254
1787198269144680385404892752894564839536763900274678107805453979
2258647705798816058573803806584150109345506944172099289308793902
6076113942453885528462909169228214743529728190793686851390092579
9656502420771789328874792543300718546965688286890288155951465131
5186464454647125070331490742787379455108001336878979604116203089
4936553091121550284294666546172989445646260089027402943502129992
3416112954802126507451527774830315092752782798921886225700543310
8132925415227587968063809347302536501854548691604450257243249597
2573932971275184888953998863410999465233643856606606772370330090
4102652247582099873209568009259074712792990362549839352008268697
2424804323968129268947229842183388606534181161154786337875195808
5711659638769584265349783287598505182683747166157140929027354771
2040244545591688260979933294687357211796596202173042187273366500
3775504110235117084505372270175432280800917828593954353814188838
8064386813993610665069915199972265473603007089273505029382836937
2652697447724733644998876844474879517708742520031525095534071894
6662372147641930682272118468334850103137745706748808131017998311
3287857502500430957464372538844729720649840563937708783478683530
6196800659249217011668981243132859817893149558410445569118190937
8127631769940754485522551517449011728627629222436508842975393227
9264985428148070096770708644409931'''
prime8192 = int(str8192.replace('\n', ''))

str16384='''5948657476786158825428796633140035653817223435482551187363374106
1663067909024184345224429773630601995755771874241965462944883369
0654343713137262349170782503040435817183002448761071625809765723
4229761728547410679235183237324154923923571404839228070692380221
6920244306145264342765661807934799994289505317850906040768166039
0482161856378582145306703437601208682661975133940044533758686135
3054178237728778903967158111067259519089298153451556719253287696
8032482259664158914588382948270264255677806718489664086294400795
4207337644916269031709617444299949490311557012560837236025936219
6606615992014713526706834756373695072969084491444972225867001823
0896418856903720567289592428679753858521882209587194482244268884
2369161120304119539530699737837667369892008245871310742614507423
8361679889485791986671131748674057208265388791254944630154473948
0233807655212863007090341151379400172097572766385079903564079479
8584706982804219752491585627531141013313100024021074904100001030
4967168406188119289403137398635364387414192193525240170823166685
0669270299902035095433119365080250909413128686188313962039946585
8854403950870132703965488209824438934802008758845969343994044004
4721256294134848441820970669728900789221824730263568277274531635
9371426594755013934755966174840435181521809696379634617241040641
7148682239343431032084521229277568266027525254094945933423431899
9588237736456857867503505075987795487265200165157603417591082470
9781834803887405529914245067180573460713706090524753898963777832
2582491925031025533258542323684732018320284669732418586091676478
4369560213200018058093946390978550260472813806533517759201650553
2255099771758381334433481388191030217124017895320767710636647337
8036503453544435248062525034078329626380648832032749173746330899
4120311561052046372922827936324232088250800615879370173631309786
4454073309882577691537221235484931737681388517811356307252627456
2614724020074557397840679937984256404287622135935727727042447493
0775103974034904696078290276595828208405529832270799757384542915
6486075164940829257103653074044401088490916920856469843918572978
7923026291571464223624851849274062647887960468225011325713624974
7903541019830414237754609455760666605240059869418182889127666629
9442607816271966751065765606704069522551062768185395174795848156
2962100583938595054467627957269744108448558971634686804319537236
3963755583575635531982125406767765686067764452699013014893226598
9755048821646954596233011443945645032710505914364914935369107985
8592284770257701514586653646255082299676311030039792367458624775
1030495720745961983589495891222358238871429233914283775029452914
3086306940850070640014493786320895413940693702779204690761722134
9506369087488280198902050385133290897001612911169804091452004912
6327596908542822735099034486090672179196710709789369505548272840
9968046069127742582260799877009196770152106207735211803823646945
7260771180491083336631586212380939179014795738430893318159114361
5778165394681950699916345067169543645034504712473915234802495239
3030462243816859301621861278781666457006952676830408115547805992
3805674311594239575516280648900956124651701722392700032539101437
2300313704901203987194702135912682888952695475010283847770057620
5906202847932537151836938822038231469653997205945273476661428825
3963781019973810632145104301710579129330202982468462940058971907
5726247272468371715767613943138561092509261335234989307513844479
0181413170301573148397542120346951643235082070943247026678711628
5481589494419261180466811978504321049018116014600980751090021091
6592590472035887103691723643464404120102215489851146655599729166
5235260306902274966118353573248222858828711024057543138192984761
2650817413395712865736226880516695328499586570618091932290163529
9015828502053225473696623019553945149452992703405606484858891277
4904871733412807236091998591594354625552015041849585724932041102
0435877983059015985517698997871747773014363691765745362923197099
3167523141230308656584861789674897286411215883478467384529363109
7734546074808295351123880751664076892751959467185840739390128068
5356879868472361213152868451139705740414799537083765622593631756
0999718893178910886731545131680272673594028981209369337825837511
0936386095451226231047995542295054596392035522722519035324638366
2229644232403234807790642054537551039427721578401124504521307436
7819818899409005339156989521126188946071791609928972393489657828
3212832323257032151391533007552118508151059322439156060127848889
5387063851511685692839248752506312827153514826450217725677929641
6140081392801513462844775667305769193316161743511480820042635698
1763101025293768468176513379253690286171704095172316596784040563
2365400708455546480098666732594515949239803785984231443711924528
8362725635859818296338372847917957644633616603508832626089012737
9436947596327113998560617652664707392696440151012026508274289847
6223328498967096829694779655524678785219804832688707031607997437
2547643104017347649507416641204182143580698291466188017437693504
8610318501699868680482414069787256791745876787200384143955058948
0239'''
prime16384 = int(str16384.replace('\n', ''))

str32768='''7077305155224773945007765138724758006740653557361940836171928741
3618331712042262679801267823832420753773793648082806324619490428
9772368924440969148125436595871963896772456505525081325638978514
9234801058916214667606037727067424849284259255706442575816007414
9769452754873031104931783750167696461213929146783220813128638665
4076638757173240156685994306314740741781219089464479433888925036
0991580874206259777954983360093225468204254018398151101836006919
2243339572464236875913140656154171951862183922021044856996188913
9476385156159389164502447273532744538798417698008576801585025185
6510073812219363505556897772421548593311534418880052376742207468
0024597173952063599646009766599153246505308236362071947043884258
2329474327443085820562236987813120816375075063327684990510646785
0330211527412430204415828179314178643185230291762018780428728456
1973694894599954298817260185232998357871361976791825356682845440
7623040069597784730536003150795186477415369322195569008032672065
5656038021320269487204144523310235916171887737136438459708707679
7325544149545223893159273689926419403022878446397181696196443634
0963751014786481565420427426869968538440517823089691527741716938
0257010188072123744514845090795932599055257726839835518835914098
5456773950956584165466539868720409866991576361952035795405610654
7563385358803000644449444685355448124431180751934602607268454129
0984608827965326626964181660712972055673017377546830140728451531
7530092964763064813166550934113815878387476728552938611778383977
8460120394554535260626993565515631951146517372183678466254976094
4142376811556582226421143202447109046318692118154656215124572939
3196406735959305208233030267800079598138932318914770682988539132
3489618144531308221209035785519641275644674424137261446529780858
9300970173491209024437656375390548018185802479537899976832098182
0851446378669583529039840926303711304750718759471928960803583877
0383042802802053061518334833717338861736337782229495835634207050
4005157269588683329736424783374420176533106432325918993469262999
0166230993259092812221103961684364725426820426054370943695424910
1355298540237240124909429005745465259256356899401814550819358139
2894370726072145130931383011445062422634150383236784143824391638
6335990821433945210397222844719659299154517352258844336616312695
6148824762219940201850715283380690179962779261359100977143758793
6836237553888394673322362743238935241531653854311850077629290027
3987823574961362245057140287488478209237660598361161310648208283
9428302446208492457548711480267061166726938490639621782883195898
1558025746113141641276665307719387629230147022535644450265947212
6377233257075678556809356343745730083487519624305025378422102341
5890315516270287038972137227114043819620868409252581879955182565
9953164737314966022926090612159961619321224736971952193281782120
1873596624222609327284605125173953529997691158259710550984838028
7632213401424151515902152866766114025090143017087584459413730313
0211343291475703534575235945247462894983252470029411685355750024
3447809670329659241931684703420491195171857220868801958711750552
6614423425712108977586451459325501805492054201325464679698152817
1565235443625565195384059700450549277891429689145821067883064111
0517397887297366552374126267330127132658844990463940411639827876
5916075124884626800333951134014830850074816434270978133059764021
2432670073893899234908805165775036313650813379772601109436923551
9352586091463595879614752858479476985318083554104740470293589523
4311617447957398232195009629583756885932416434518007822771097504
2280493075191740142004015029009724785781413731897697351253018777
3267939314073804302228394685756531795747304268080618637136631901
8686143816948559151625018177948879104784505123025781714554627932
4691227622751002901091371574048690375113878256101870526136079531
0264637595933353023766429661268389653053521105436690049192775379
5903206730482292797658179985589642141802365734334272742380690873
7958198682267099482246617431985153881988806012952338187527366951
1112472836204661934127888139091976546911687564099980435567807391
7827597618333028177839420944931142007337029526497585110355702222
5063833211016572961858562974389841716326051163990675116495586590
9588518256190354335219090487980113007580649844849714709304223780
9569060727647194792937118895817350648062275089836029742919128222
9232652995688312404206721882519946223166725080354435990602107177
8786311859465608090901077400319475059119672085607102247653613200
8338399505812310156123234277327185772358677613870078814543369855
3379226049960666710175720194805329463266960914378114663350338992
1696744585475993892539710974572399408008596616550324781014004707
4732189725076542703112540735939792947043958046070811876172556375
5338515832018405811659601458704236944788161555266712130764736620
0581396111293926996751148730803138741955524454004708748642053405
1003322838749646884545681426859650479387611044335454861947707433
2322003781572351409810171382657562720048630873246999687908698590
5899120868049297912973424271829336684332988551533883233895270077
2212874568414203613948954364642072541122596028194432953158935906
2306344742230582284028703764584212715928898420760531600187354925
7615238563414467925544088398145052569163585829524682851129019787
7158857178064132780122249679117614222411292944156232427711984797
6521996823338731407857526669958299904468156580039569809363350548
0113121556451402378216078623909903898425035456194567444403598166
4401981474878876959208882634933356103191983474725454856632040355
3432671647279439086259496188191403291526093127814532492071842455
1660665420720825646265560666181872875364736125758127176803349527
1632027429962617369505882199235175356181718483113017028109239731
0857997301720333440877836810988621768479140767357115572006171629
0239603708964380285431305964157162139009424842562006126670680536
5019108248384854108369900681312331838829127704469900378479440296
5929214009445042942211599316066438160453994039204523017462382989
2232678358588575033498214643783035144477098224524429604083640730
4411717521381564087599327676804907500145098239293437114800743628
2766940716795004999099672729257296129521384930559808484013869723
9797370915669878190667508432900151286297338446046644832218651171
6806828221681245195269010018911061603494580379091850211604286282
7335435869739386654054464025209613488405913543362512461019389619
5686850938973793719009532760637580943853200183404770316807132711
4425573821555409358998188723668043435502459349438259592737057380
3214342299181480630993213239676682160294375442625711991306942222
0088524230369045064312248183532335386142191665724524075240206736
3071679284897476418896936232369010279777285397989082721384229658
5005260125638847471446156335486707902003315975293037020003178004
4288344319261516219437508955046677291831042336628911983451041045
6677235312125463344160584143058128115219240924825270670635542435
3190458393277045698310634777607078246636059962612827619756557123
9758401978659207926349193138690072921390873902012108756736288747
8420492279357901112561992894120851299538340848602706687573961756
0629476037807165792576450660607288713280579722545187333436194800
2124749617582634222663182316424444122026681266139563327856134162
5217156823885847829147563692849244375568272428425026415270056177
6839475617602738814102668550253249825726859021108932446064486488
9210249114419944154745697670937056122625508635804293652573748060
8356873414986755967137868813615815712193554397834618816043956720
4113407881700931927397139093894063349539697072613259790989208925
4744032266373263639049367523497147541289857902093782398637300590
8285165509002845479967239698108420185442059291404853353415460545
4844179785836032630607777961069731020514676456643740376097497032
4270094102928692978231156428287619460090500038951761073280974891
9094024413839801265923214294241850335934077911621973640969840761
2462874887262553301772762650751902358359690564651851733817749744
2898852337482411299728681019711101571429612628339679740246330834
8204878621363350262456514461444728365252294444752449585537962694
6164058711382232081374596264798948878793335614805395647696032711
7906663125672039633169336068537927971238529686057096860830976479
4748302809589246861842650769592772693328788197239077209842023601
1474083185832187134243650149318336501147144556894820502991740379
6704134236287854949642783345221633822556802979450052016442305686
0234844783234493851510888952457870131702988513233823500646706503
4662022530540194974846373998274538396398018949701813458456431273
8070848893999963703711161425234853481938297325712784891046393557
5839972392238823236504722594491981372058948812008355518040605378
3832640915537156763249880199047885158876787117312516614859216921
7405009450621207810101070683061101428975352038832010168911187924
0518200932267933425168007434136057592128113044363949630267163731
0529094707358921031994667576994699471627481100864480111613324572
4845527447129840501263148025309493075707312464066984881970585683
2884934338759958624613101680427301728084999655872102117614416692
9011170054673476469545530719736980989927438049475986719626420042
6700784018073849121050232544902782411767230328850556505648863824
1824845029928007029639292687906178915878622504378490729019354198
3622122434385522671841361619542211667563583799298471717188138048
9702967893957585001309677018039979566992205898066832593875066082
0289834473807322045040211272439820105217363981919689055523045762
1511223209526533306336540910377816064481008353074176673561581088
9191939201003784295824795967165911176128149569257040355132223044
2690424074108541149665012207295449529857902935871908279263431988
1160237490507098088542745122119017130482046321763026099513694292
9372258607883141867288168428186620360298816793871239695795221680
1826112734011201822889507411844462818125491825477034967758269974
8038323244114025872350235508533027497633967570519687203636713171
5153728889140659042089828855805686190855618893312545691428557742
4763535606193250407517156101893095878286826871626531707746535466
0299912446050070794371036631907988821056863839376378442171565459
57666357'''
prime32768 = int(str32768.replace('\n', ''))

bigs=prime4096, prime8192, prime16384

def test_len():
    assert prime4096.bit_length() == 4096
    assert prime8192.bit_length() == 8192
    assert prime16384.bit_length() == 16384
    assert prime32768.bit_length() == 32768

def test4096():
    import pseudo_prime
    assert pseudo_prime.baillie_psw(prime4096)

def test8192():
    import pseudo_prime
    assert pseudo_prime.baillie_psw(prime8192)

def test16384():
    import pseudo_prime
    assert pseudo_prime.miller_rabin1(prime16384, 3)
    #assert pseudo_prime.baillie_psw(prime16384)

def test32768():
    # Hard coded M-R test.
    assert prime32768 & 7 == 5
    assert pow(-3, (prime32768-1) // 4, prime32768) == 1
